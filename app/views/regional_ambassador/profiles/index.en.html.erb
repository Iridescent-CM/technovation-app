<p class="appy-subtitle">
  You're browsing users in your region: <%= current_ambassador.region_name %>.
</p>

<div class="flex-row">
  <div class="flex-col-md-4">
    <div class="admin-search__filter-options">
      <%= render 'regional_ambassador/profiles/filter_options' %>
    </div>
  </div>

  <div class="flex-col-md-8 wrapper__report-column">
    <div class="admin-results-table">
      <div class="admin-results-header-table">
        <div class="header">
          <%= fa_icon("caret-square-o-down",
                      text: "Type",
                      class: "header-filter-menu",
                      data: { menu: "header-menu-type" }) %>
        </div>

        <div class="header">
          <%= fa_icon("caret-square-o-down",
                      text: "Signed up",
                      class: "header-filter-menu",
                      data: { menu: "header-menu-created-at" }) %>
        </div>

        <div class="header">
          <%= fa_icon("caret-square-o-down",
                      text: "Name",
                      class: "header-filter-menu",
                      data: { menu: "header-menu-name" }) %>
        </div>

        <div class="header">On a team?</div>

        <div class="header">
          <%= fa_icon("caret-square-o-down",
                      text: "Email",
                      class: "header-filter-menu",
                      data: { menu: "header-menu-email" }) %>
        </div>

        <% if params[:type] == "Student" %>
          <div class="header">Parent Email</div>
        <% end %>

        <div class="header">
          <%= fa_icon("caret-square-o-down",
                      text: "School / Company name",
                      class: "header-filter-menu",
                      data: { menu: "header-menu-school" }) %>
        </div>

        <div class="header">
          <%= fa_icon("caret-square-o-down",
                      text: "Division",
                      class: "header-filter-menu",
                      data: { menu: "header-menu-division" }) %>
        </div>

        <div class="header">Referred by</div>

        <div class="header">
          <%= fa_icon("caret-square-o-down",
                      text: "Location",
                      class: "header-filter-menu",
                      data: { menu: "header-menu-location" }) %>
        </div>
      </div>

      <div class="admin-results-data-table">
        <% @accounts.each do |account| %>
          <div class="row">
            <div class="cell">
              <%= account.type_name %>
            </div>

            <div class="cell">
              <% if account.created_at.year == Time.current.year %>
                <%= time_ago_in_words(account.created_at) %> ago
              <% else %>
                <%= account.created_at.strftime("%b %e, %Y") %>
              <% end %>
            </div>

            <div class="cell">
              <%= link_to account.full_name, regional_ambassador_user_path(account) %>
            </div>

            <div class="cell">
              <% if %w{student mentor}.include?(account.type_name) %>
                <%= account.teams.current.any? ? "yes" : "no" %>
              <% end %>
            </div>

            <div class="cell">
              <%= mail_to account.email %>
            </div>

            <% if params[:type] == "Student" %>
              <div class="cell"><%= mail_to account.student_profile.parent_guardian_email %></div>
            <% end %>

            <div class="cell">
              <%= account.get_school_company_name %>
            </div>

            <div class="cell">
              <%= account.division %>
            </div>

            <div class="cell">
              <%= account.referred_by %>
              <%= account.referred_by_other %>
            </div>

            <div class="cell">
              <%= account.address_details %>
            </div>
          </div>
        <% end %>
      </div>
    </div>

    <div class="wrapper__report-footer">
      <%= render 'regional_ambassador/profiles/footer' %>
    </div>
  </div>
</div>

<div id="menu-underlay"></div>
<%= render layout: 'sorting_header_menu', locals: { id: "type" } do %>
  <%= content_tag :li, data: { filter_select: true, reload: true } do %>
    <%= select_tag :type,
      options_for_select(%w{All Mentor Student RegionalAmbassador Judge}, params[:type]) %>
  <% end %>
<% end %>

<%= render 'sorting_header_menu', id: "created-at", value: "accounts.created_at" %>
<%= render 'sorting_header_menu', id: "name", value: "LOWER(accounts.last_name)" %>
<%= render 'sorting_header_menu', id: "email", value: "LOWER(accounts.email)" %>
<%= render 'sorting_header_menu', id: "school" %>
<%= render 'sorting_header_menu', id: "division" %>
<%= render 'sorting_header_menu', id: "location", value: "LOWER(accounts.city)" %>
